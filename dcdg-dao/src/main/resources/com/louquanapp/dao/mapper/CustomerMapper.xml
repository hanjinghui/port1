<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.louquanapp.dao.mapper.CustomerMapper">
    <resultMap id="BaseResultMap" type="com.louquanapp.dao.model.Customer">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Thu Mar 28 11:18:11 CST 2019.
        -->
        <id column="CUST_ID" jdbcType="CHAR" property="custId"/>
        <result column="CUST_TYPE" jdbcType="INTEGER" property="custType"/>
        <result column="LOGIN_NAME" jdbcType="VARCHAR" property="loginName"/>
        <result column="LOGIN_PWD" jdbcType="VARCHAR" property="loginPwd"/>
        <result column="CUST_PHONE" jdbcType="VARCHAR" property="custPhone"/>
        <result column="CUST_SEX" jdbcType="TINYINT" property="custSex"/>
        <result column="PAY_PWD" jdbcType="VARCHAR" property="payPwd"/>
        <result column="PAY_CHECK_WAY" jdbcType="TINYINT" property="payCheckWay"/>
        <result column="AREA_PATH" jdbcType="VARCHAR" property="areaPath"/>
        <result column="CUST_EMAIL" jdbcType="VARCHAR" property="custEmail"/>
        <result column="NICK_NAME" jdbcType="VARCHAR" property="nickName"/>
        <result column="REAL_NAME" jdbcType="VARCHAR" property="realName"/>
        <result column="ID_CARD" jdbcType="VARCHAR" property="idCard"/>
        <result column="FRONT_ID_CARD" jdbcType="VARCHAR" property="frontIdCard"/>
        <result column="END_ID_CARD" jdbcType="VARCHAR" property="endIdCard"/>
        <result column="AUTH_TIME" jdbcType="TIMESTAMP" property="authTime"/>
        <result column="AUTH_INFO" jdbcType="VARCHAR" property="authInfo"/>
        <result column="AUTH_STATUS" jdbcType="TINYINT" property="authStatus"/>
        <result column="LIVE_ADDRESS" jdbcType="VARCHAR" property="liveAddress"/>
        <result column="HEAD_IMG" jdbcType="VARCHAR" property="headImg"/>
        <result column="FREEZE_STATUS" jdbcType="TINYINT" property="freezeStatus"/>
        <result column="PUSH_ID" jdbcType="VARCHAR" property="pushId"/>
        <result column="INVITER_CODE" jdbcType="VARCHAR" property="inviterCode"/>
        <result column="IS_JOIN" jdbcType="TINYINT" property="isJoin"/>
        <result column="REGIST_SOURCE" jdbcType="TINYINT" property="registSource"/>
        <result column="REGIST_TIME" jdbcType="TIMESTAMP" property="registTime"/>
        <result column="REGIST_IP" jdbcType="VARCHAR" property="registIp"/>
        <result column="WECHAT_ID" jdbcType="VARCHAR" property="wechatId"/>
        <result column="WECHAT_DATA" jdbcType="VARCHAR" property="wechatData"/>
        <result column="QQ_ID" jdbcType="VARCHAR" property="qqId"/>
        <result column="QQ_JSON" jdbcType="VARCHAR" property="qqJson"/>
        <result column="SINA_ID" jdbcType="VARCHAR" property="sinaId"/>
        <result column="SINA_JSON" jdbcType="VARCHAR" property="sinaJson"/>
        <result column="ERR_TIMES" jdbcType="TINYINT" property="errTimes"/>
        <result column="ERR_TIME" jdbcType="TIMESTAMP" property="errTime"/>
        <result column="LOGIN_TIME" jdbcType="TIMESTAMP" property="loginTime"/>
        <result column="BIRTH_DATE" jdbcType="DATE" property="birthDate"/>
        <result column="REMARK" jdbcType="VARCHAR" property="remark"/>
        <result column="SHOP_TOKEN" jdbcType="VARCHAR" property="shopToken"/>
        <result column="TOKEN_LIMIT_TIME" jdbcType="TIMESTAMP" property="tokenLimitTime"/>
        <result column="IS_COUNTRY_MANAGE" jdbcType="TINYINT" property="isCountryManage"/>
        <result column="ONLINE_FLAG" jdbcType="TINYINT" property="onlineFlag"/>
        <result column="CUST_LEVEL" jdbcType="VARCHAR" property="custLevel"/>
        <result column="INVITE_CODE" jdbcType="VARCHAR" property="inviteCode"/>
        <result column="DATA_PERM" jdbcType="VARCHAR" property="dataPerm"/>
        <result column="CONSUME_POINT" jdbcType="DOUBLE" property="consumePoint"/>
        <result column="CXY_POINT" jdbcType="DOUBLE" property="cxyPoint"/>
        <result column="DEDUCTION_POINT" jdbcType="DOUBLE" property="deductionPoint"/>
        <result column="IS_USER_AGREEMENT" jdbcType="TINYINT" property="isUserAgreement"/>
    </resultMap>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Thu Mar 28 11:18:11 CST 2019.
        -->
        delete from dcdg_bussiness_customer_base
        where CUST_ID = #{custId,jdbcType=CHAR}
    </delete>
    <insert id="insert" parameterType="com.louquanapp.dao.model.Customer">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Thu Mar 28 11:18:11 CST 2019.
        -->
        insert into dcdg_bussiness_customer_base (CUST_ID, CUST_TYPE, LOGIN_NAME,
        LOGIN_PWD, CUST_PHONE, CUST_SEX,
        PAY_PWD, PAY_CHECK_WAY, AREA_PATH,
        CUST_EMAIL, NICK_NAME, REAL_NAME,
        ID_CARD, FRONT_ID_CARD, END_ID_CARD,
        AUTH_TIME, AUTH_INFO, AUTH_STATUS,
        LIVE_ADDRESS, HEAD_IMG, FREEZE_STATUS,
        PUSH_ID, INVITER_CODE, IS_JOIN,
        REGIST_SOURCE, REGIST_TIME, REGIST_IP,
        WECHAT_ID, WECHAT_DATA, QQ_ID,
        QQ_JSON, SINA_ID, SINA_JSON,
        ERR_TIMES, ERR_TIME, LOGIN_TIME,
        BIRTH_DATE, REMARK, SHOP_TOKEN,
        TOKEN_LIMIT_TIME, IS_COUNTRY_MANAGE, ONLINE_FLAG,
        CUST_LEVEL, INVITE_CODE, DATA_PERM,
        CONSUME_POINT, CXY_POINT, DEDUCTION_POINT,
        IS_USER_AGREEMENT)
        values (#{custId,jdbcType=CHAR}, #{custType,jdbcType=INTEGER}, #{loginName,jdbcType=VARCHAR},
        #{loginPwd,jdbcType=VARCHAR}, #{custPhone,jdbcType=VARCHAR}, #{custSex,jdbcType=TINYINT},
        #{payPwd,jdbcType=VARCHAR}, #{payCheckWay,jdbcType=TINYINT}, #{areaPath,jdbcType=VARCHAR},
        #{custEmail,jdbcType=VARCHAR}, #{nickName,jdbcType=VARCHAR}, #{realName,jdbcType=VARCHAR},
        #{idCard,jdbcType=VARCHAR}, #{frontIdCard,jdbcType=VARCHAR}, #{endIdCard,jdbcType=VARCHAR},
        #{authTime,jdbcType=TIMESTAMP}, #{authInfo,jdbcType=VARCHAR}, #{authStatus,jdbcType=TINYINT},
        #{liveAddress,jdbcType=VARCHAR}, #{headImg,jdbcType=VARCHAR}, #{freezeStatus,jdbcType=TINYINT},
        #{pushId,jdbcType=VARCHAR}, #{inviterCode,jdbcType=VARCHAR}, #{isJoin,jdbcType=TINYINT},
        #{registSource,jdbcType=TINYINT}, #{registTime,jdbcType=TIMESTAMP}, #{registIp,jdbcType=VARCHAR},
        #{wechatId,jdbcType=VARCHAR}, #{wechatData,jdbcType=VARCHAR}, #{qqId,jdbcType=VARCHAR},
        #{qqJson,jdbcType=VARCHAR}, #{sinaId,jdbcType=VARCHAR}, #{sinaJson,jdbcType=VARCHAR},
        #{errTimes,jdbcType=TINYINT}, #{errTime,jdbcType=TIMESTAMP}, #{loginTime,jdbcType=TIMESTAMP},
        #{birthDate,jdbcType=DATE}, #{remark,jdbcType=VARCHAR}, #{shopToken,jdbcType=VARCHAR},
        #{tokenLimitTime,jdbcType=TIMESTAMP}, #{isCountryManage,jdbcType=TINYINT}, #{onlineFlag,jdbcType=TINYINT},
        #{custLevel,jdbcType=VARCHAR}, #{inviteCode,jdbcType=VARCHAR}, #{dataPerm,jdbcType=VARCHAR},
        #{consumePoint,jdbcType=DOUBLE}, #{cxyPoint,jdbcType=DOUBLE}, #{deductionPoint,jdbcType=DOUBLE},
        #{isUserAgreement,jdbcType=TINYINT})
    </insert>
    <update id="updateByPrimaryKey" parameterType="com.louquanapp.dao.model.Customer">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Thu Mar 28 11:18:11 CST 2019.
        -->
        update dcdg_bussiness_customer_base
        set CUST_TYPE = #{custType,jdbcType=INTEGER},
        LOGIN_NAME = #{loginName,jdbcType=VARCHAR},
        LOGIN_PWD = #{loginPwd,jdbcType=VARCHAR},
        CUST_PHONE = #{custPhone,jdbcType=VARCHAR},
        CUST_SEX = #{custSex,jdbcType=TINYINT},
        PAY_PWD = #{payPwd,jdbcType=VARCHAR},
        PAY_CHECK_WAY = #{payCheckWay,jdbcType=TINYINT},
        AREA_PATH = #{areaPath,jdbcType=VARCHAR},
        CUST_EMAIL = #{custEmail,jdbcType=VARCHAR},
        NICK_NAME = #{nickName,jdbcType=VARCHAR},
        REAL_NAME = #{realName,jdbcType=VARCHAR},
        ID_CARD = #{idCard,jdbcType=VARCHAR},
        FRONT_ID_CARD = #{frontIdCard,jdbcType=VARCHAR},
        END_ID_CARD = #{endIdCard,jdbcType=VARCHAR},
        AUTH_TIME = #{authTime,jdbcType=TIMESTAMP},
        AUTH_INFO = #{authInfo,jdbcType=VARCHAR},
        AUTH_STATUS = #{authStatus,jdbcType=TINYINT},
        LIVE_ADDRESS = #{liveAddress,jdbcType=VARCHAR},
        HEAD_IMG = #{headImg,jdbcType=VARCHAR},
        FREEZE_STATUS = #{freezeStatus,jdbcType=TINYINT},
        PUSH_ID = #{pushId,jdbcType=VARCHAR},
        INVITER_CODE = #{inviterCode,jdbcType=VARCHAR},
        IS_JOIN = #{isJoin,jdbcType=TINYINT},
        REGIST_SOURCE = #{registSource,jdbcType=TINYINT},
        REGIST_TIME = #{registTime,jdbcType=TIMESTAMP},
        REGIST_IP = #{registIp,jdbcType=VARCHAR},
        WECHAT_ID = #{wechatId,jdbcType=VARCHAR},
        WECHAT_DATA = #{wechatData,jdbcType=VARCHAR},
        QQ_ID = #{qqId,jdbcType=VARCHAR},
        QQ_JSON = #{qqJson,jdbcType=VARCHAR},
        SINA_ID = #{sinaId,jdbcType=VARCHAR},
        SINA_JSON = #{sinaJson,jdbcType=VARCHAR},
        ERR_TIMES = #{errTimes,jdbcType=TINYINT},
        ERR_TIME = #{errTime,jdbcType=TIMESTAMP},
        LOGIN_TIME = #{loginTime,jdbcType=TIMESTAMP},
        BIRTH_DATE = #{birthDate,jdbcType=DATE},
        REMARK = #{remark,jdbcType=VARCHAR},
        SHOP_TOKEN = #{shopToken,jdbcType=VARCHAR},
        TOKEN_LIMIT_TIME = #{tokenLimitTime,jdbcType=TIMESTAMP},
        IS_COUNTRY_MANAGE = #{isCountryManage,jdbcType=TINYINT},
        ONLINE_FLAG = #{onlineFlag,jdbcType=TINYINT},
        CUST_LEVEL = #{custLevel,jdbcType=VARCHAR},
        INVITE_CODE = #{inviteCode,jdbcType=VARCHAR},
        DATA_PERM = #{dataPerm,jdbcType=VARCHAR},
        CONSUME_POINT = #{consumePoint,jdbcType=DOUBLE},
        CXY_POINT = #{cxyPoint,jdbcType=DOUBLE},
        DEDUCTION_POINT = #{deductionPoint,jdbcType=DOUBLE},
        IS_USER_AGREEMENT = #{isUserAgreement,jdbcType=TINYINT}
        where CUST_ID = #{custId,jdbcType=CHAR}
    </update>
    <select id="selectByPrimaryKey" parameterType="java.lang.String" resultMap="BaseResultMap">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Thu Mar 28 11:18:11 CST 2019.
        -->
        select CUST_ID, CUST_TYPE, LOGIN_NAME, LOGIN_PWD, CUST_PHONE, CUST_SEX, PAY_PWD,
        PAY_CHECK_WAY, AREA_PATH, CUST_EMAIL, NICK_NAME, REAL_NAME, ID_CARD, FRONT_ID_CARD,
        END_ID_CARD, AUTH_TIME, AUTH_INFO, AUTH_STATUS, LIVE_ADDRESS, HEAD_IMG, FREEZE_STATUS,
        PUSH_ID, INVITER_CODE, IS_JOIN, REGIST_SOURCE, REGIST_TIME, REGIST_IP, WECHAT_ID,
        WECHAT_DATA, QQ_ID, QQ_JSON, SINA_ID, SINA_JSON, ERR_TIMES, ERR_TIME, LOGIN_TIME,
        BIRTH_DATE, REMARK, SHOP_TOKEN, TOKEN_LIMIT_TIME, IS_COUNTRY_MANAGE, ONLINE_FLAG,
        CUST_LEVEL, INVITE_CODE, DATA_PERM, CONSUME_POINT, CXY_POINT, DEDUCTION_POINT, IS_USER_AGREEMENT
        from dcdg_bussiness_customer_base
        where CUST_ID = #{custId,jdbcType=CHAR}
    </select>
    <select id="selectAll" resultMap="BaseResultMap">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Thu Mar 28 11:18:11 CST 2019.
        -->
        select CUST_ID, CUST_TYPE, LOGIN_NAME, LOGIN_PWD, CUST_PHONE, CUST_SEX, PAY_PWD,
        PAY_CHECK_WAY, AREA_PATH, CUST_EMAIL, NICK_NAME, REAL_NAME, ID_CARD, FRONT_ID_CARD,
        END_ID_CARD, AUTH_TIME, AUTH_INFO, AUTH_STATUS, LIVE_ADDRESS, HEAD_IMG, FREEZE_STATUS,
        PUSH_ID, INVITER_CODE, IS_JOIN, REGIST_SOURCE, REGIST_TIME, REGIST_IP, WECHAT_ID,
        WECHAT_DATA, QQ_ID, QQ_JSON, SINA_ID, SINA_JSON, ERR_TIMES, ERR_TIME, LOGIN_TIME,
        BIRTH_DATE, REMARK, SHOP_TOKEN, TOKEN_LIMIT_TIME, IS_COUNTRY_MANAGE, ONLINE_FLAG,
        CUST_LEVEL, INVITE_CODE, DATA_PERM, CONSUME_POINT, CXY_POINT, DEDUCTION_POINT, IS_USER_AGREEMENT
        from dcdg_bussiness_customer_base
    </select>
    <sql id="Base_Column_List">
           CUST_ID, CUST_TYPE, LOGIN_NAME, LOGIN_PWD, CUST_PHONE, PAY_PWD, PAY_CHECK_WAY,
        AREA_PATH, CUST_EMAIL, NICK_NAME, REAL_NAME, ID_CARD, LIVE_ADDRESS, HEAD_IMG, FREEZE_STATUS,
        PUSH_ID, INVITER_CODE, IS_JOIN, REGIST_SOURCE, REGIST_TIME, REGIST_IP, AUTH_TIME,
        AUTH_INFO, AUTH_STATUS, WECHAT_ID, WECHAT_DATA, QQ_ID, SINA_ID,
        ERR_TIMES, ERR_TIME, LOGIN_TIME, BIRTH_DATE, CUST_SEX,  SHOP_TOKEN, TOKEN_LIMIT_TIME,
        IS_COUNTRY_MANAGE, ONLINE_FLAG, CUST_LEVEL, INVITE_CODE, DATA_PERM, CONSUME_POINT,
        CXY_POINT, DEDUCTION_POINT, IS_USER_AGREEMENT

    </sql>


    <select id="getByPhone" parameterType="java.lang.String" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from dcdg_bussiness_customer_base
        where CUST_PHONE = #{wechatId,jdbcType=CHAR}
    </select>
    <select id="getByWechatId" parameterType="java.lang.String" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from dcdg_bussiness_customer_base
        where WECHAT_ID = #{wechatId,jdbcType=CHAR}
    </select>
    <select id="getByQqId" parameterType="java.lang.String" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from dcdg_bussiness_customer_base
        where QQ_ID = #{qqId,jdbcType=CHAR}
    </select>

    <select id="getBySinaId" parameterType="java.lang.String" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from dcdg_bussiness_customer_base
        where SINA_ID = #{sinaId,jdbcType=CHAR}
    </select>

    <select id="existCustomerByPhone" parameterType="java.lang.String" resultType="int">
        select count(1)
        from dcdg_bussiness_customer_base
        where CUST_PHONE = #{custPhone,jdbcType=CHAR}
    </select>
    <select id="existCustId" parameterType="java.lang.String" resultType="int">
        select count(1)
        from dcdg_bussiness_customer_base
        where CUST_ID = #{custId,jdbcType=CHAR}
    </select>

    <select id="getPushIdByCustId" parameterType="java.lang.String" resultType="String">
        select PUSH_ID
        from dcdg_bussiness_customer_base
         WHERE CUST_ID =
        #{custId,jdbcType=CHAR}
    </select>

    <select id="selectCountByOpenIdAndType" parameterType="java.util.Map" resultType="java.lang.Integer">
        select count(1)
        from dcdg_bussiness_customer_base
        where CUST_ID = #{custId,jdbcType=CHAR}
        <if test="type != null and type == '1'.toString()">
            AND QQ_ID=#{otherId}
        </if>
        <if test="type != null and type == '2'.toString()">
            AND WECHAT_ID=#{otherId}
        </if>
        <if test="type != null and type == '3'.toString()">
            AND SINA_ID=#{otherId}
        </if>
    </select>

    <select id="selectNameByPrimaryKey" parameterType="java.lang.String" resultType="java.lang.String">

    select NICK_NAME
    from dcdg_bussiness_customer_base
    where CUST_ID = #{custId,jdbcType=CHAR}
  </select>


    <select id="selectNickNameAndRealNameAndPhoneAndPwdByPrimaryKey" parameterType="java.lang.String"
            resultMap="BaseResultMap">
        select NICK_NAME,CUST_PHONE,HEAD_IMG,LOGIN_PWD,PAY_PWD,REAL_NAME,CUST_TYPE,DATA_PERM,CUST_TYPE
        from dcdg_bussiness_customer_base
        where CUST_ID = #{custId,jdbcType=CHAR}
    </select>
    <update id="updateByPrimaryKeySelective" parameterType="com.louquanapp.dao.model.Customer">
        UPDATE dcdg_bussiness_customer_base
        <set>
            <if test="custType != null">
                CUST_TYPE=#{custType,jdbcType=INTEGER},
            </if>
            <if test="loginName != null">
                LOGIN_NAME=#{loginName,jdbcType=VARCHAR},
            </if>
            <if test="loginPwd != null">
                LOGIN_PWD=#{loginPwd,jdbcType=VARCHAR},
            </if>
            <if test="custPhone != null">
                CUST_PHONE=#{custPhone,jdbcType=VARCHAR},
            </if>
            <if test="payPwd != null">
                PAY_PWD=#{payPwd,jdbcType=VARCHAR},
            </if>
            <if test="payCheckWay != null">
                PAY_CHECK_WAY=#{payCheckWay,jdbcType=TINYINT},
            </if>
            <if test="areaPath != null">
                AREA_PATH=#{areaPath,jdbcType=VARCHAR},
            </if>
            <if test="custEmail != null">
                CUST_EMAIL=#{custEmail,jdbcType=VARCHAR},
            </if>
            <if test="nickName != null">
                NICK_NAME=#{nickName,jdbcType=VARCHAR},
            </if>
            <if test="realName != null">
                REAL_NAME=#{realName,jdbcType=VARCHAR},
            </if>
            <if test="idCard != null">
                ID_CARD=#{idCard,jdbcType=VARCHAR},
            </if>
            <if test="frontIdCard != null">
                FRONT_ID_CARD = #{frontIdCard,jdbcType=VARCHAR},
            </if>
            <if test="endIdCard != null">
                END_ID_CARD = #{endIdCard,jdbcType=VARCHAR},
            </if>

            <if test="liveAddress != null">
                LIVE_ADDRESS=#{liveAddress,jdbcType=VARCHAR},
            </if>
            <if test="headImg != null">
                HEAD_IMG=#{headImg,jdbcType=VARCHAR},
            </if>
            <if test="freezeStatus != null">
                FREEZE_STATUS=#{freezeStatus,jdbcType=TINYINT},
            </if>
            <if test="pushId != null">
                PUSH_ID=#{pushId,jdbcType=VARCHAR},
            </if>
            <if test="inviterCode != null">
                INVITER_CODE=#{inviterCode,jdbcType=VARCHAR},
            </if>
            <if test="isJoin != null">
                IS_JOIN=#{isJoin,jdbcType=TINYINT},
            </if>
            <if test="registSource != null">
                REGIST_SOURCE=#{registSource,jdbcType=TINYINT},
            </if>
            <if test="registTime != null">
                REGIST_TIME=#{registTime,jdbcType=TIMESTAMP},
            </if>
            <if test="registIp != null">
                REGIST_IP=#{registIp,jdbcType=VARCHAR},
            </if>
            <if test="authTime != null">
                AUTH_TIME=#{authTime,jdbcType=TIMESTAMP},
            </if>
            <if test="authInfo != null">
                AUTH_INFO=#{authInfo,jdbcType=VARCHAR},
            </if>
            <if test="authStatus != null">
                AUTH_STATUS=#{authStatus,jdbcType=TINYINT},
            </if>


            <if test="wechatId != null">
                WECHAT_ID=#{wechatId,jdbcType=VARCHAR},
            </if>
            <if test="wechatData != null">
                WECHAT_DATA=#{wechatData,jdbcType=VARCHAR},
            </if>
            <if test="qqId != null">
                QQ_ID=#{qqId,jdbcType=VARCHAR},
            </if>
            <if test="qqJson != null">
                QQ_JSON=#{qqJson,jdbcType=VARCHAR},
            </if>
            <if test="sinaId != null">
                SINA_ID=#{sinaId,jdbcType=VARCHAR},
            </if>
            <if test="sinaJson != null">
                SINA_JSON=#{sinaJson,jdbcType=VARCHAR},
            </if>
            <if test="errTimes != null">
                ERR_TIMES=#{errTimes,jdbcType=TINYINT},
            </if>
            <if test="errTime != null">
                ERR_TIME=#{errTime,jdbcType=TIMESTAMP},
            </if>
            <if test="loginTime != null">
                LOGIN_TIME=#{loginTime,jdbcType=TIMESTAMP},
            </if>
            <if test="birthDate != null">
                BIRTH_DATE=#{birthDate,jdbcType=TIMESTAMP},
            </if>
            <if test="custSex != null">
                CUST_SEX=#{custSex,jdbcType=TINYINT},
            </if>
            <if test="remark != null">
                REMARK=#{remark,jdbcType=VARCHAR},
            </if>
            <if test="shopToken != null">
                SHOP_TOKEN=#{shopToken,jdbcType=VARCHAR},
            </if>
            <if test="tokenLimitTime != null">
                TOKEN_LIMIT_TIME=#{tokenLimitTime,jdbcType=TIMESTAMP},
            </if>
            <if test="isCountryManage != null">
                IS_COUNTRY_MANAGE=#{isCountryManage,jdbcType=TINYINT},
            </if>
            <if test="onlineFlag != null">
                ONLINE_FLAG=#{onlineFlag,jdbcType=TINYINT},
            </if>
            <if test="custLevel != null">
                CUST_LEVEL=#{custLevel,jdbcType=VARCHAR},
            </if>
            <if test="inviteCode != null">
                INVITE_CODE=#{inviteCode,jdbcType=VARCHAR},
            </if>
            <if test="dataPerm != null">
                DATA_PERM=#{dataPerm,jdbcType=VARCHAR},
            </if>
            <if test="consumePoint != null">
                CONSUME_POINT=#{consumePoint,jdbcType=DOUBLE},
            </if>
            <if test="cxyPoint != null">
                DCDGPOINT=#{cxyPoint,jdbcType=DOUBLE},
            </if>
            <if test="deductionPoint != null">
                DEDUCTION_POINT=#{deductionPoint,jdbcType=DOUBLE},
            </if>
        </set>
        WHERE CUST_ID =
        #{custId,jdbcType=CHAR}
    </update>


    <select id="getHeadImgMapByCustIdIn" parameterType="java.util.List" resultMap="BaseResultMap">
        select CUST_ID, HEAD_IMG,CUST_PHONE,REAL_NAME from dcdg_bussiness_customer_base
        <choose>
            <when test="list != null and list.size()>0">
                WHERE CUST_ID in
                <foreach collection="list" item="id" open="(" separator=","
                         close=")">#{id}
                </foreach>
            </when>
            <otherwise>
                1=2
            </otherwise>
        </choose>
    </select>

    <select id="getHeadImgMapByCustId" parameterType="String" resultType="String">
        select  HEAD_IMG from dcdg_bussiness_customer_base
         WHERE CUST_ID =
        #{custId,jdbcType=CHAR}
    </select>

    <select id="selectFalgByInviterCode" parameterType="String" resultType="int">
      select  ONLINE_FLAG from dcdg_bussiness_customer_base
         WHERE CUST_ID =
        #{custId,jdbcType=CHAR}
    </select>

    <update id="updateDeductionPointAndConsumePointByCustIdAndVersionDeductionPoint"
            parameterType="com.louquanapp.dao.model.Customer">
        UPDATE dcdg_bussiness_customer_base
        <set>
            <if test="deductionPoint != null">
                DEDUCTION_POINT=#{deductionPoint,jdbcType=DOUBLE},
            </if>

            <if test="consumePoint != null">
                CONSUME_POINT=#{consumePoint,jdbcType=DOUBLE},
            </if>

            <if test="onlineFlag != null">
                ONLINE_FLAG = #{onlineFlag,jdbcType=TINYINT},
            </if>
        </set>
        WHERE CUST_ID =
        #{custId,jdbcType=CHAR} AND DEDUCTION_POINT=#{versionDeductionPoint,jdbcType=DOUBLE}
    </update>


    <select id="getDeductionPointByCustId" parameterType="String" resultType="Double">
        select DEDUCTION_POINT from  dcdg_bussiness_customer_base   WHERE CUST_ID =
        #{custId,jdbcType=CHAR}
    </select>

    <select id="getConsumePointByCustId" parameterType="String" resultType="Double">
        select CONSUME_POINT_POINT from  dcdg_bussiness_customer_base   WHERE CUST_ID =
        #{custId,jdbcType=CHAR}
    </select>


    <!--根据最终值 更新 积分-->
    <update id="updatePlusDeductionPointBydVersionDeductionPointAndCustId">
        UPDATE dcdg_bussiness_customer_base
        set   DEDUCTION_POINT=DEDUCTION_POINT+#{deductionPoint,jdbcType=DOUBLE}
        WHERE CUST_ID =
        #{custId,jdbcType=CHAR} AND DEDUCTION_POINT=#{versionDeductionPoint,jdbcType=DOUBLE}
    </update>
    <!--根据最终值 更新 余额-->
    <update id="updatePlusConsumePointBydVersionConsumePointAndCustId">
        UPDATE dcdg_bussiness_customer_base
        set  CONSUME_POINT=CONSUME_POINT+#{consumePoint,jdbcType=DOUBLE}
        WHERE CUST_ID =
        #{custId,jdbcType=CHAR} AND CONSUME_POINT=#{versionConsumePoint,jdbcType=DOUBLE}
    </update>

    <!--模糊查询用户昵称-->
    <select id="selectNicks" resultMap="BaseResultMap">
        select CUST_ID,NICK_NAME,HEAD_IMG from  dcdg_bussiness_customer_base   WHERE
           (
            CUST_ID != #{custId,jdbcType=VARCHAR} AND
            NICK_NAME like  CONCAT('%',#{nickName,jdbcType=VARCHAR},'%')
		    and CUST_ID not in (select FRIEND_ID from dcdg_basic_chat_base WHERE dcdg_basic_chat_base.CUST_ID= #{custId,jdbcType=VARCHAR} and CHAT_STATUS =1 and CHAT_STATUS =2)
		    ) or ( CUST_PHONE   like  CONCAT('%',#{nickName,jdbcType=VARCHAR},'%')  and CUST_ID != #{custId,jdbcType=VARCHAR}  )

    </select>

    <!--根据custId查询昵称-->
    <select id="getNickNameMapByCustId" parameterType="String" resultType="String">
        select  NICK_NAME from dcdg_bussiness_customer_base
         WHERE CUST_ID =
        #{custId,jdbcType=CHAR}
    </select>
    <select id="selectShopIdBuyVideoId" resultType="String">
        select  DATA_PERM from dcdg_bussiness_customer_base
         WHERE CUST_ID =
        (select CUST_ID from dcdg_video_video_base where VIDEO_ID=#{videoId,jdbcType=VARCHAR})
    </select>

    <!--查询第一次登录时间 -->
    <select id="queryLoginFirstTime" resultType="java.util.Map">
        select  LOGIN_FIRST_TIME  loginFirstTime , CONSUME_POINT consumePoint from dcdg_bussiness_customer_base
         WHERE CUST_ID =   #{custId,jdbcType=CHAR} and  LOGIN_FIRST_TIME is not null
    </select>
    <!--增加第一次登录时间 -->
    <update id="addLoginFirstTime" >
        update   dcdg_bussiness_customer_base set LOGIN_FIRST_TIME =  #{loginFirstTime,jdbcType=TIMESTAMP}
         WHERE CUST_ID =   #{custId,jdbcType=CHAR}  and  LOGIN_FIRST_TIME is not null
    </update>
    <!--增加剩余现金余额-->
    <update id="addConsumePoint" >
        update   dcdg_bussiness_customer_base set CONSUME_POINT =  CONSUME_POINT+ #{consumePoint,jdbcType=DOUBLE}
         WHERE CUST_ID =   #{custId,jdbcType=CHAR}

    </update>


    <update id="returnComsumeAmt" parameterType="com.louquanapp.dao.model.Customer">
		UPDATE
		    DCDG_BUSSINESS_CUSTOMER_BASE
		set
		    CONSUME_POINT= CONSUME_POINT + #{consumePoint,jdbcType=DOUBLE}
		WHERE
		    CUST_ID = #{custId,jdbcType=CHAR}
	</update>

    <update id="returnDeductionAmt" parameterType="com.louquanapp.dao.model.Customer">
		UPDATE
		    DCDG_BUSSINESS_CUSTOMER_BASE
		set
		    DEDUCTION_POINT= DEDUCTION_POINT + #{deductionPoint,jdbcType=DOUBLE}
		WHERE CUST_ID = #{custId,jdbcType=CHAR}
	</update>

    <select id="listAllCustId" resultType="String">
		SELECT CUST_ID FROM
		dcdg_bussiness_customer_base
	</select>
    <select id="custList" resultMap="BaseResultMap">
		SELECT CUST_ID,HEAD_IMG,NICK_NAME FROM
		dcdg_bussiness_customer_base  where CUST_TYPE = 1
	</select>


    <select id="inviteCustList" resultMap="BaseResultMap">
       select CUST_ID,NICK_NAME,HEAD_IMG,REGIST_TIME from  dcdg_bussiness_customer_base   WHERE INVITE_TYPE = 2
           and   INVITE_CODE = #{inviteCode,jdbcType=VARCHAR}
    </select>

    <select id="inviteCustCount" resultType="Integer">
       select count(1) from  dcdg_bussiness_customer_base   WHERE INVITE_TYPE = 2
           and   INVITE_CODE = #{inviteCode,jdbcType=VARCHAR}
    </select>

</mapper>