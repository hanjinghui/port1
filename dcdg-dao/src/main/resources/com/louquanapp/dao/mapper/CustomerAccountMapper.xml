<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.louquanapp.dao.mapper.CustomerAccountMapper">
    <resultMap id="BaseResultMap" type="com.louquanapp.dao.model.CustomerAccount">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Tue Apr 23 21:29:23 CST 2019.
        -->
        <id column="CUST_ID" jdbcType="CHAR" property="custId"/>
        <result column="LOGIN_NAME" jdbcType="VARCHAR" property="loginName"/>
        <result column="CONSUME_RMB" jdbcType="DOUBLE" property="consumeRmb"/>
        <result column="TOTAL_POINT" jdbcType="DOUBLE" property="totalPoint"/>
        <result column="CASH_POINT" jdbcType="DOUBLE" property="cashPoint"/>
        <result column="CX_POINT" jdbcType="DOUBLE" property="cxPoint"/>
        <result column="SHOP_POINT" jdbcType="DOUBLE" property="shopPoint"/>
        <result column="SURPLUS_TOTAL_POINT" jdbcType="DOUBLE" property="surplusTotalPoint"/>
        <result column="SURPLUS_CASH_POINT" jdbcType="DOUBLE" property="surplusCashPoint"/>
        <result column="SURPLUS_CX_POINT" jdbcType="DOUBLE" property="surplusCxPoint"/>
        <result column="SURPLUS_SHOP_POINT" jdbcType="DOUBLE" property="surplusShopPoint"/>
        <result column="YET_TOTAL_POINT" jdbcType="DOUBLE" property="yetTotalPoint"/>
        <result column="YET_CASH_POINT" jdbcType="DOUBLE" property="yetCashPoint"/>
        <result column="YET_CX_POINT" jdbcType="DOUBLE" property="yetCxPoint"/>
        <result column="YET_SHOP_POINT" jdbcType="DOUBLE" property="yetShopPoint"/>
        <result column="ADD_TIME" jdbcType="TIMESTAMP" property="addTime"/>
        <result column="UPDATE_TIME" jdbcType="TIMESTAMP" property="updateTime"/>
        <result column="TOP_USER_ID" jdbcType="CHAR" property="topUserId"/>
        <result column="INVITE_PATH" jdbcType="VARCHAR" property="invitePath"/>
        <result column="MANAGE_PHONE" jdbcType="CHAR" property="managePhone"/>
        <result column="RECO_BUY_COUNT" jdbcType="INTEGER" property="recoBuyCount"/>
        <result column="SELF_BUY_COUNT" jdbcType="DOUBLE" property="selfBuyCount"/>
        <result column="TOTAL_FOUCUS_COUNT" jdbcType="INTEGER" property="totalFoucusCount"/>
    </resultMap>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Tue Apr 23 21:29:23 CST 2019.
        -->
        delete from dcdg_bussiness_customer_account
        where CUST_ID = #{custId,jdbcType=CHAR}
    </delete>
    <insert id="insert" parameterType="com.louquanapp.dao.model.CustomerAccount">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Tue Apr 23 21:29:23 CST 2019.
        -->
        insert into dcdg_bussiness_customer_account (CUST_ID, LOGIN_NAME, CONSUME_RMB,
        TOTAL_POINT, CASH_POINT, CX_POINT,
        SHOP_POINT, SURPLUS_TOTAL_POINT, SURPLUS_CASH_POINT,
        SURPLUS_CX_POINT, SURPLUS_SHOP_POINT, YET_TOTAL_POINT,
        YET_CASH_POINT, YET_CX_POINT, YET_SHOP_POINT,
        ADD_TIME, UPDATE_TIME, TOP_USER_ID,
        INVITE_PATH, MANAGE_PHONE, RECO_BUY_COUNT,
        SELF_BUY_COUNT, TOTAL_FOUCUS_COUNT)
        values (#{custId,jdbcType=CHAR}, #{loginName,jdbcType=VARCHAR}, #{consumeRmb,jdbcType=DOUBLE},
        #{totalPoint,jdbcType=DOUBLE}, #{cashPoint,jdbcType=DOUBLE}, #{cxPoint,jdbcType=DOUBLE},
        #{shopPoint,jdbcType=DOUBLE}, #{surplusTotalPoint,jdbcType=DOUBLE}, #{surplusCashPoint,jdbcType=DOUBLE},
        #{surplusCxPoint,jdbcType=DOUBLE}, #{surplusShopPoint,jdbcType=DOUBLE}, #{yetTotalPoint,jdbcType=DOUBLE},
        #{yetCashPoint,jdbcType=DOUBLE}, #{yetCxPoint,jdbcType=DOUBLE}, #{yetShopPoint,jdbcType=DOUBLE},
        #{addTime,jdbcType=TIMESTAMP}, #{updateTime,jdbcType=TIMESTAMP}, #{topUserId,jdbcType=CHAR},
        #{invitePath,jdbcType=VARCHAR}, #{managePhone,jdbcType=CHAR}, #{recoBuyCount,jdbcType=INTEGER},
        #{selfBuyCount,jdbcType=DOUBLE}, #{totalFoucusCount,jdbcType=INTEGER})
    </insert>
    <update id="updateByPrimaryKey" parameterType="com.louquanapp.dao.model.CustomerAccount">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Tue Apr 23 21:29:23 CST 2019.
        -->
        update dcdg_bussiness_customer_account
        set LOGIN_NAME = #{loginName,jdbcType=VARCHAR},
        CONSUME_RMB = #{consumeRmb,jdbcType=DOUBLE},
        TOTAL_POINT = #{totalPoint,jdbcType=DOUBLE},
        CASH_POINT = #{cashPoint,jdbcType=DOUBLE},
        CX_POINT = #{cxPoint,jdbcType=DOUBLE},
        SHOP_POINT = #{shopPoint,jdbcType=DOUBLE},
        SURPLUS_TOTAL_POINT = #{surplusTotalPoint,jdbcType=DOUBLE},
        SURPLUS_CASH_POINT = #{surplusCashPoint,jdbcType=DOUBLE},
        SURPLUS_CX_POINT = #{surplusCxPoint,jdbcType=DOUBLE},
        SURPLUS_SHOP_POINT = #{surplusShopPoint,jdbcType=DOUBLE},
        YET_TOTAL_POINT = #{yetTotalPoint,jdbcType=DOUBLE},
        YET_CASH_POINT = #{yetCashPoint,jdbcType=DOUBLE},
        YET_CX_POINT = #{yetCxPoint,jdbcType=DOUBLE},
        YET_SHOP_POINT = #{yetShopPoint,jdbcType=DOUBLE},
        ADD_TIME = #{addTime,jdbcType=TIMESTAMP},
        UPDATE_TIME = #{updateTime,jdbcType=TIMESTAMP},
        TOP_USER_ID = #{topUserId,jdbcType=CHAR},
        INVITE_PATH = #{invitePath,jdbcType=VARCHAR},
        MANAGE_PHONE = #{managePhone,jdbcType=CHAR},
        RECO_BUY_COUNT = #{recoBuyCount,jdbcType=INTEGER},
        SELF_BUY_COUNT = #{selfBuyCount,jdbcType=DOUBLE},
        TOTAL_FOUCUS_COUNT = #{totalFoucusCount,jdbcType=INTEGER}
        where CUST_ID = #{custId,jdbcType=CHAR}
    </update>
    <select id="selectByPrimaryKey" parameterType="java.lang.String" resultMap="BaseResultMap">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Tue Apr 23 21:29:23 CST 2019.
        -->
        select CUST_ID, LOGIN_NAME, CONSUME_RMB, TOTAL_POINT, CASH_POINT, CX_POINT, SHOP_POINT,
        SURPLUS_TOTAL_POINT, SURPLUS_CASH_POINT, SURPLUS_CX_POINT, SURPLUS_SHOP_POINT, YET_TOTAL_POINT,
        YET_CASH_POINT, YET_CX_POINT, YET_SHOP_POINT, ADD_TIME, UPDATE_TIME, TOP_USER_ID,
        INVITE_PATH, MANAGE_PHONE, RECO_BUY_COUNT, SELF_BUY_COUNT, TOTAL_FOUCUS_COUNT
        from dcdg_bussiness_customer_account
        where CUST_ID = #{custId,jdbcType=CHAR}
    </select>
    <select id="selectAll" resultMap="BaseResultMap">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Tue Apr 23 21:29:23 CST 2019.
        -->
        select CUST_ID, LOGIN_NAME, CONSUME_RMB, TOTAL_POINT, CASH_POINT, CX_POINT, SHOP_POINT,
        SURPLUS_TOTAL_POINT, SURPLUS_CASH_POINT, SURPLUS_CX_POINT, SURPLUS_SHOP_POINT, YET_TOTAL_POINT,
        YET_CASH_POINT, YET_CX_POINT, YET_SHOP_POINT, ADD_TIME, UPDATE_TIME, TOP_USER_ID,
        INVITE_PATH, MANAGE_PHONE, RECO_BUY_COUNT, SELF_BUY_COUNT, TOTAL_FOUCUS_COUNT
        from dcdg_bussiness_customer_account
    </select>


    <update id="updateSelfBuyCountAndSurplusTotalPointAndSurplusShopPointAndSurplusCashPointAndComsumeRbmByUpdateTimeAndCustId" parameterType="com.louquanapp.dao.model.CustomerAccount">
        update dcdg_bussiness_customer_account
        <set>
            UPDATE_TIME = #{updateTime,jdbcType=TIMESTAMP},
            <if test="null!=surplusTotalPoint">
                SURPLUS_TOTAL_POINT = #{surplusTotalPoint,jdbcType=DOUBLE},
            </if>
            <if test="null!=surplusShopPoint">
                SURPLUS_SHOP_POINT = #{surplusShopPoint,jdbcType=DOUBLE},
            </if>
            <if test="null!=surplusCashPoint">
                SURPLUS_CASH_POINT = #{surplusCashPoint,jdbcType=DOUBLE},
            </if>
            <if test="null!=consumeRmb">
                CONSUME_RMB = #{consumeRmb,jdbcType=DOUBLE},
            </if>
        </set>
        where CUST_ID = #{custId,jdbcType=CHAR} AND UPDATE_TIME = #{versionUpdateTime,jdbcType=TIMESTAMP}
    </update>


    <update id="updatePlusDeductionPointBydVersionDeductionPointAndCustId">
        update dcdg_bussiness_customer_account
        set
        UPDATE_TIME =now(),
        SURPLUS_TOTAL_POINT =SURPLUS_TOTAL_POINT+ #{surplusShopPoint,jdbcType=DOUBLE},
        SURPLUS_SHOP_POINT = SURPLUS_SHOP_POINT+#{surplusShopPoint,jdbcType=DOUBLE}
        where CUST_ID = #{custId,jdbcType=CHAR} AND SURPLUS_SHOP_POINT = #{versionSurplusShopPoint,jdbcType=DOUBLE}
    </update>


    <update id="updatePlusConsumePointBydVersionConsumePointAndCustId">
        update dcdg_bussiness_customer_account
        set
        UPDATE_TIME =now(),
            SURPLUS_TOTAL_POINT =SURPLUS_TOTAL_POINT+ #{surplusCashPoint,jdbcType=DOUBLE},
            SURPLUS_CASH_POINT =SURPLUS_CASH_POINT+ #{surplusCashPoint,jdbcType=DOUBLE}
        where CUST_ID = #{custId,jdbcType=CHAR} AND SURPLUS_CASH_POINT =#{versionSurplusCashPoint,jdbcType=DOUBLE}
    </update>
    <update id="updatePlusTotalFocusCountByCustId">
        update dcdg_bussiness_customer_account
        set  TOTAL_FOUCUS_COUNT = TOTAL_FOUCUS_COUNT+1
        where CUST_ID = #{custId,jdbcType=CHAR}
    </update>

    <update id="updateMinusTotalFocusCountByCustId">
        update dcdg_bussiness_customer_account
        set  TOTAL_FOUCUS_COUNT =TOTAL_FOUCUS_COUNT-1
        where CUST_ID = #{custId,jdbcType=CHAR}
    </update>

    <select id="selectFocusCountByPrimaryKey" resultType="int">
        select TOTAL_FOUCUS_COUNT from  dcdg_bussiness_customer_account
        where CUST_ID = #{custId,jdbcType=CHAR}
    </select>


    <update id="returnComsumeAmt" parameterType="com.louquanapp.dao.model.CustomerAccount">
		UPDATE
	    	dcdg_BUSSINESS_CUSTOMER_ACCOUNT
		set
            SURPLUS_TOTAL_POINT=SURPLUS_TOTAL_POINT+ #{surplusTotalPoint,jdbcType=DOUBLE},
            SURPLUS_CASH_POINT=SURPLUS_CASH_POINT + #{surplusCashPoint,jdbcType=DOUBLE}
		WHERE CUST_ID = #{custId,jdbcType=CHAR}
	</update>
    <update id="returnDeductionAmt" parameterType="com.louquanapp.dao.model.CustomerAccount">
		UPDATE
		    dcdg_BUSSINESS_CUSTOMER_ACCOUNT
		set
		    UPDATE_TIME =now(),
		    SURPLUS_TOTAL_POINT=SURPLUS_TOTAL_POINT+#{surplusTotalPoint,jdbcType=DOUBLE},
		    SURPLUS_SHOP_POINT=SURPLUS_SHOP_POINT+#{surplusShopPoint,jdbcType=DOUBLE}
		WHERE CUST_ID = #{id,jdbcType=CHAR}
	</update>
</mapper>