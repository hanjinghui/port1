<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.louquanapp.dao.mapper.MoneySettlementMapper">
  <resultMap id="BaseResultMap" type="com.louquanapp.dao.model.MoneySettlement">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Sep 04 15:43:52 CST 2019.
    -->
    <id column="MONEY_ID" jdbcType="CHAR" property="moneyId" />
    <result column="CASH_OUT_CONSUME_VALUE" jdbcType="DOUBLE" property="cashOutConsumeValue" />
    <result column="VALUE_TYPE" jdbcType="TINYINT" property="valueType" />
    <result column="CASH_OUT_POINT_PERCENTAGE" jdbcType="DOUBLE" property="cashOutPointPercentage" />
    <result column="CASH_OUT_BALANCE_PERCENTAGE" jdbcType="DOUBLE" property="cashOutBalancePercentage" />
    <result column="MONEY_VALUE" jdbcType="DOUBLE" property="moneyValue" />
    <result column="USER_ID" jdbcType="CHAR" property="userId" />
    <result column="SHOP_ID" jdbcType="CHAR" property="shopId" />
    <result column="SETTLEMENT_STATUS" jdbcType="TINYINT" property="settlementStatus" />
    <result column="APPLY_SETTLEMENT_TIME" jdbcType="TIMESTAMP" property="applySettlementTime" />
    <result column="IN_SETTLEMENT_TIME" jdbcType="TIMESTAMP" property="inSettlementTime" />
    <result column="OUT_SETTLEMENT_TIME" jdbcType="TIMESTAMP" property="outSettlementTime" />
    <result column="ACCOUNT_ID" jdbcType="CHAR" property="accountId" />
    <result column="ADD_TIME" jdbcType="TIMESTAMP" property="addTime" />
  </resultMap>
  <resultMap id="ExtraBaseResultMap" extends="BaseResultMap" type="com.louquanapp.dao.model.MoneySettlement">
    <result column="ACCOUNT_NUMBER" jdbcType="VARCHAR" property="accountNumber" />
    <result column="BANK_ICO" jdbcType="VARCHAR" property="bankIco" />
    <result column="BANK_NAME" jdbcType="VARCHAR" property="bankName" />
  </resultMap>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Sep 04 15:43:52 CST 2019.
    -->
    delete from dcdg_money_settlement_info
    where MONEY_ID = #{moneyId,jdbcType=CHAR}
  </delete>
  <insert id="insert" parameterType="com.louquanapp.dao.model.MoneySettlement">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Sep 04 15:43:52 CST 2019.
    -->
    insert into dcdg_money_settlement_info (MONEY_ID, CASH_OUT_CONSUME_VALUE, VALUE_TYPE, 
      CASH_OUT_POINT_PERCENTAGE, CASH_OUT_BALANCE_PERCENTAGE, 
      MONEY_VALUE, USER_ID, SHOP_ID, 
      SETTLEMENT_STATUS, APPLY_SETTLEMENT_TIME, 
      IN_SETTLEMENT_TIME, OUT_SETTLEMENT_TIME, 
      ACCOUNT_ID, ADD_TIME)
    values (#{moneyId,jdbcType=CHAR}, #{cashOutConsumeValue,jdbcType=DOUBLE}, #{valueType,jdbcType=TINYINT}, 
      #{cashOutPointPercentage,jdbcType=DOUBLE}, #{cashOutBalancePercentage,jdbcType=DOUBLE}, 
      #{moneyValue,jdbcType=DOUBLE}, #{userId,jdbcType=CHAR}, #{shopId,jdbcType=CHAR}, 
      #{settlementStatus,jdbcType=TINYINT}, #{applySettlementTime,jdbcType=TIMESTAMP}, 
      #{inSettlementTime,jdbcType=TIMESTAMP}, #{outSettlementTime,jdbcType=TIMESTAMP}, 
      #{accountId,jdbcType=CHAR}, #{addTime,jdbcType=TIMESTAMP})
  </insert>
  <update id="updateByPrimaryKey" parameterType="com.louquanapp.dao.model.MoneySettlement">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Sep 04 15:43:52 CST 2019.
    -->
    update dcdg_money_settlement_info
    set CASH_OUT_CONSUME_VALUE = #{cashOutConsumeValue,jdbcType=DOUBLE},
      VALUE_TYPE = #{valueType,jdbcType=TINYINT},
      CASH_OUT_POINT_PERCENTAGE = #{cashOutPointPercentage,jdbcType=DOUBLE},
      CASH_OUT_BALANCE_PERCENTAGE = #{cashOutBalancePercentage,jdbcType=DOUBLE},
      MONEY_VALUE = #{moneyValue,jdbcType=DOUBLE},
      USER_ID = #{userId,jdbcType=CHAR},
      SHOP_ID = #{shopId,jdbcType=CHAR},
      SETTLEMENT_STATUS = #{settlementStatus,jdbcType=TINYINT},
      APPLY_SETTLEMENT_TIME = #{applySettlementTime,jdbcType=TIMESTAMP},
      IN_SETTLEMENT_TIME = #{inSettlementTime,jdbcType=TIMESTAMP},
      OUT_SETTLEMENT_TIME = #{outSettlementTime,jdbcType=TIMESTAMP},
      ACCOUNT_ID = #{accountId,jdbcType=CHAR},
      ADD_TIME = #{addTime,jdbcType=TIMESTAMP}
    where MONEY_ID = #{moneyId,jdbcType=CHAR}
  </update>
  <select id="selectByPrimaryKey" parameterType="java.lang.String" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Sep 04 15:43:52 CST 2019.
    -->
    select MONEY_ID, CASH_OUT_CONSUME_VALUE, VALUE_TYPE, CASH_OUT_POINT_PERCENTAGE, CASH_OUT_BALANCE_PERCENTAGE, 
    MONEY_VALUE, USER_ID, SHOP_ID, SETTLEMENT_STATUS, APPLY_SETTLEMENT_TIME, IN_SETTLEMENT_TIME, 
    OUT_SETTLEMENT_TIME, ACCOUNT_ID, ADD_TIME
    from dcdg_money_settlement_info
    where MONEY_ID = #{moneyId,jdbcType=CHAR}
  </select>
  <select id="selectAll" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Sep 04 15:43:52 CST 2019.
    -->
    select MONEY_ID, CASH_OUT_CONSUME_VALUE, VALUE_TYPE, CASH_OUT_POINT_PERCENTAGE, CASH_OUT_BALANCE_PERCENTAGE, 
    MONEY_VALUE, USER_ID, SHOP_ID, SETTLEMENT_STATUS, APPLY_SETTLEMENT_TIME, IN_SETTLEMENT_TIME, 
    OUT_SETTLEMENT_TIME, ACCOUNT_ID, ADD_TIME
    from dcdg_money_settlement_info
  </select>

  <!--资金结算记录-->
  <select id="walletListBySettleStatus" resultMap="BaseResultMap">
     select MONEY_ID,APPLY_SETTLEMENT_TIME,IN_SETTLEMENT_TIME,OUT_SETTLEMENT_TIME,SETTLEMENT_STATUS,VALUE_TYPE,CASH_OUT_CONSUME_VALUE,MONEY_VALUE
     from   dcdg_money_settlement_info
    where    USER_ID = #{userId,jdbcType=CHAR}
      <if test="monthBegin!= null and monthBegin != '' ">
        and  ADD_TIME &gt;= #{monthBegin}
      </if>
      <if test="monthEnd!= null and monthEnd != '' ">
        and ADD_TIME &lt;= #{monthEnd}
      </if>
  </select>
  <select id="earliestSettlementMonth" resultType="java.util.Date">
        select  min(ADD_TIME)  from dcdg_money_settlement_info where   USER_ID = #{userId,jdbcType=CHAR}
    </select>



  <select id="ettlesdDetail" resultMap="ExtraBaseResultMap">
        select    a.MONEY_ID
                ,a.MONEY_VALUE
                ,a.CASH_OUT_CONSUME_VALUE
                ,a.VALUE_TYPE
                ,a.SETTLEMENT_STATUS
                ,a.APPLY_SETTLEMENT_TIME
                ,a.IN_SETTLEMENT_TIME
                ,a.OUT_SETTLEMENT_TIME
                ,a.ACCOUNT_ID
                ,b.ACCOUNT_NUMBER
                ,c.`BANK_ICO`
                ,c.`BANK_NAME`

		from               dcdg_money_settlement_info a
						left join  dcdg_customer_account_base    b on a.ACCOUNT_ID=b.ACCOUNT_ID
						left join  dcdg_basic_bank_base          c on b.BANK_TYPE_ID=c.BANK_ID
		where           a.USER_ID   = #{userId,jdbcType=CHAR}
			    	and a.MONEY_ID  = #{moneyId,jdbcType=CHAR}


    </select>

</mapper>